FROM node:16 AS build

WORKDIR /var/www

COPY . .

ARG VITE_DOCS_BASEPATH
ARG VITE_DOCS_EXAMPLES_VUE_PATH

ENV VITE_DOCS_BASEPATH=$VITE_DOCS_BASEPATH
ENV VITE_DOCS_EXAMPLES_VUE_PATH=$VITE_DOCS_EXAMPLES_VUE_PATH

RUN yarn
RUN yarn build:peer-next
RUN yarn build:nuxt

WORKDIR /var/www/apps/preview/nuxt

CMD ["yarn", "serve"]
