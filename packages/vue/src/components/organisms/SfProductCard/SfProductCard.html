<div class="sf-product-card">
  <button
    v-if="wishlistIcon !== false"
    :aria-label="ariaLabel"
    :class="wishlistIconClasses"
    @click="toggleIsOnWishlist"
  >
    <!-- @slot -->
    <slot name="wishlist-icon" v-bind="{ currentWishlistIcon }">
      <SfIcon
        :icon="currentWishlistIcon"
        color="black"
        size="22px"
        data-test="sf-wishlist-icon"
      />
    </slot>
  </button>
  <component
    :is="linkComponentTag"
    :href="linkComponentTag === 'a' ? link : undefined"
    :to="link && linkComponentTag !== 'a' ? link : undefined"
    class="sf-product-card__link"
  >
    <!-- @slot -->
    <div ref="productImage" class="sf-product-card__image-wrapper">
      <slot name="image" v-bind="{ image, title }">
        <div v-if="Array.isArray(image)" class="sf-product-card__pictures">
          <div
            v-for="picture in image.slice(0, 2)"
            class="sf-product-card__picture"
          >
            <div class="sf-product-card__image">
              <SfImage :src="picture" :alt="title" :width="216" :height="326"/>
            </div>
          </div>
        </div>
        <div v-else class="sf-product-card__image">
          <SfImage :src="image" :alt="title" :width="216" :height="326"/>
        </div>
      </slot>
      <template v-if="showAddToCartButton">
        <!-- @slot -->
        <slot
          name="add-to-cart"
          v-bind="{ isAddedToCart, showAddedToCartBadge, isAddingToCart }"
        >
          <SfCircleIcon
            class="sf-product-card__add-button"
            aria-label="add-to-cart"
            role="button"
            :has-badge="showAddedToCartBadge"
            :disabled="addToCartDisabled"
            @click="onAddToCart"
          >
            <div class="sf-product-card__add-button--icons">
              <transition
                name="sf-product-card__add-button--icons"
                mode="out-in"
              >
                <slot v-if="!isAddingToCart" name="add-to-cart-icon">
                  <SfIcon
                    key="add_to_cart"
                    icon="add_to_cart"
                    size="20px"
                    color="white"
                  />
                </slot>
                <slot v-else name="adding-to-cart-icon">
                  <SfIcon
                    key="added_to_cart"
                    icon="added_to_cart"
                    size="20px"
                    color="white"
                  />
                </slot>
              </transition>
            </div>
          </SfCircleIcon>
        </slot>
      </template>
    </div>
    <!-- @slot -->
    <slot name="title" v-bind="{ title }">
      <h3 class="sf-product-card__title">
        {{ title }}
      </h3>
    </slot>
  </component>
  <!-- @slot -->
  <slot name="price" v-bind="{ specialPrice, regularPrice }">
    <SfPrice
      v-if="regularPrice"
      class="sf-product-card__price"
      :regular="regularPrice"
      :special="specialPrice"
    />
  </slot>
  <!-- @slot -->
  <slot name="reviews" v-bind="{ maxRating, scoreRating }">
    <div
      v-if="typeof scoreRating === 'number'"
      class="sf-product-card__reviews"
    >
      <SfRating
        class="sf-product-card__rating"
        :max="maxRating"
        :score="scoreRating"
      />
      <a
        v-if="reviewsCount"
        class="sf-product-card__reviews-count"
        href="#"
        @click="$emit('click:reviews')"
      >
        ({{ reviewsCount }})
      </a>
    </div>
  </slot>
</div>
